# Copyright (C)2013 Will (Wil) Cooley
#
#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License.
#

[(?::){0}*puppet*]
REPORT-syslog = syslog-extractions
SHOULD_LINEMERGE = False
EXTRACT-puppet-filebucket = (?i)FileBucket .* \{md5\}(?P<filebucket_hash>.*)
EXTRACT-puppet-resource-changed = changed\s+'(?P<resource_attribute_old>[^']*)'\s+to\s+'(?P<resource_attribute_new>[^']*)'
EXTRACT-puppet-resource-shouldbe = current_value\s+(?P<resource_attribute_old>[^,]*),\s+should\s+be\s+(?P<resource_attribute_new>[^[:space:]]*)
EXTRACT-puppet-node = (on\s+node|node\s+for|node\s+cache\s+of|catalog\s+for)\s+(?P<node_fdqn>(?P<node>[\w-]+)\.[\w.-]*)
EXTRACT-puppet-catalog-run-time = Finished catalog run in (?P<catalog_run_time>\d+(\.\d+)?) seconds
EXTRACT-puppet-resource = (?:source="|\()(?:Scope\()?(?P<resource>(?:/Stage\[(?P<run_stage>[^]]+)\]/(?P<class>[^/]+))?(?:/(?P<defined_type>[^[]+)\[(?P<defined_instance>[^]]+)\])?/?(?P<resource_type>[^[]+)\[(?P<resource_instance>[^]]+)\](?:/(?P<resource_attribute>[^)"]+))?)(?:"|\)(?:\s+(?P<resource_result>.*)$)?)
EXTRACT-puppet-resource-basic = (?P<resource>\(/(?P<resource_type>[A-Z][^[]+)\[(?P<resource_instance>[^]]+)\](?:/(?P<resource_attribute>[^)]+))?\))\s+(?P<resource_result>.*)$
EXTRACT-puppet-resource-node = /Node\[(?P<node>[^]]+)\]/
EXTRACT-puppet-environment = environment\s+(?P<environment>[^\s:]+)
EXTRACT-puppet-event-msg = puppet-\w+\[\d+\]:\s+(?:\[cimlog[^]]+\])?\s*(?P<event_msg>.*)
